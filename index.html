<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Bang Dieu Khien LED</title>
<style>
  body { font-family: Arial; text-align: center; background: #f5f5f5; }
  .container { margin: 20px auto; width: 90%; max-width: 500px; }
  .buttons button { width: 48%; height: 50px; margin: 5px 1%; font-size: 16px; }
  .mode button { width: 48%; margin: 10px 1%; padding: 10px; }
  textarea { width: 100%; height: 80px; margin-top: 10px; font-size: 16px; }
</style>
</head>
<body>
<div class="container">
  <h2>Dieu khien LED hien thi</h2>

  <div class="mode">
    <button onclick="setMode('manual')">Che do thu cong</button>
    <button onclick="setMode('auto')">Che do tu dong</button>
  </div>

  <div id="manual-controls">
    <textarea id="inputText" placeholder="Nhap noi dung hien thi..."></textarea><br>
    <button onclick="sendText()">Gui noi dung</button>

    <div class="buttons">
      <button onclick="sendGold('VANG MIENG SJC')">Vang mieng SJC</button>
      <button onclick="sendGold('NHAN SJC 9999')">Nhan SJC</button>
      <button onclick="sendGold('NHA NUOC DOJI')">Doji</button>
      <button onclick="sendGold('PNJ 9999')">PNJ</button>
    </div>
  </div>

  <p id="status"></p>
</div>

<script>
async function setMode(mode) {
  await fetch("/api/message", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ mode })
  });
  document.getElementById("status").innerText = "Da chuyen sang che do: " + mode;
  document.getElementById("manual-controls").style.display = (mode === "manual") ? "block" : "none";
}

async function sendText() {
  const text = document.getElementById("inputText").value;
  await fetch("/api/message", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message: { type: "custom", text } })
  });
  document.getElementById("status").innerText = "Da gui noi dung thu cong";
}

async function sendGold(name) {
  await fetch("/api/message", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message: { type: "gold", text: name } })
  });
  document.getElementById("status").innerText = "Da gui thong tin: " + name;
}
</script>
</body>
</html>
